function updatePreview(){$(".preview-editor").empty();var t=document.createElement("iframe");t.setAttribute("id","preview"),t.setAttribute("sandbox","allow-forms allow-modals allow-pointer-lock allow-popups allow-same-origin allow-scripts"),document.querySelector(".preview-editor").appendChild(t);var e=document.getElementById("preview"),o=e.contentDocument||e.contentWindow.document;o.open(),o.write('<!DOCTYPE html>\n<html>\n  <head>\n    <title>site title</title>\n    <meta charset="utf-8">\n    <meta name="viewport" content="initial-scale=1.0">\n    <meta name="description" content="Saved to gist">\n    <style>\n'+cssEditor.getValue()+"\n    </style>\n  </head>\n  <body>\n"+htmlEditor.getValue()+"\n\n    <script>\n      "+jsEditor.getValue()+"\n    </script>\n  </body>\n</html>"),o.close()}function loadgist(t){$.ajax({url:"https://api.github.com/gists/"+t,type:"GET",dataType:"jsonp",jsonp:"callback"}).success(function(t){var e=t.data.files["index.html"],o=t.data.files["style.css"],i=t.data.files["script.js"];e?htmlEditor.setValue(e.content):htmlEditor.setValue(""),o?cssEditor.setValue(o.content):cssEditor.setValue(""),i?jsEditor.setValue(i.content):jsEditor.setValue("")}).error(function(t){console.warn("Error: Could not load weave!",t),alertify.error("Error: Could not load weave!")})}var delay,htmlEditor=CodeMirror.fromTextArea(document.getElementById("htmlEditor"),{mode:"text/html",tabMode:"indent",styleActiveLine:!0,lineNumbers:!0,lineWrapping:!0,autoCloseTags:!0,foldGutter:!0,dragDrop:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"]}),cssEditor=CodeMirror.fromTextArea(document.getElementById("cssEditor"),{mode:"text/css",tabMode:"indent",styleActiveLine:!0,lineNumbers:!0,lineWrapping:!0,autoCloseTags:!0,foldGutter:!0,dragDrop:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"]}),jsEditor=CodeMirror.fromTextArea(document.getElementById("jsEditor"),{mode:"text/javascript",tabMode:"indent",styleActiveLine:!0,lineNumbers:!0,lineWrapping:!0,autoCloseTags:!0,foldGutter:!0,dragDrop:!0,lint:{options:{asi:!0}},gutters:["CodeMirror-lint-markers","CodeMirror-linenumbers","CodeMirror-foldgutter"]});htmlEditor.on("change",function(){clearTimeout(delay),delay=setTimeout(updatePreview,300)}),cssEditor.on("change",function(){clearTimeout(delay),delay=setTimeout(updatePreview,300)}),jsEditor.on("change",function(){clearTimeout(delay),delay=setTimeout(updatePreview,300)}),setTimeout(updatePreview,300),$("#splitContainer, #leftSplitter, #rightSplitter").jqxSplitter({theme:"metro"}),$("#splitContainer").jqxSplitter({height:"100%",width:"100%",orientation:"horizontal",showSplitBar:!0,panels:[{size:"50%",collapsible:!1},{size:"50%"}]}),$("#leftSplitter").jqxSplitter({height:"100%",width:"100%",orientation:"vertical",showSplitBar:!0,panels:[{size:"50%",collapsible:!1},{size:"50%"}]}),$("#rightSplitter").jqxSplitter({height:"100%",width:"100%",orientation:"vertical",showSplitBar:!0,panels:[{size:"50%"},{size:"50%",collapsible:!1}]}),$("[data-action=save]").click(function(){var t=(document.getElementById("htmlEditor").value,htmlEditor.getValue()),e=(document.getElementById("cssEditor").value,cssEditor.getValue()),o=(document.getElementById("jsEditor").value,jsEditor.getValue()),i={description:"My exported snippet","public":!0,files:{"index.html":{content:t},"style.css":{content:e},"script.js":{content:o}}};$.ajax({url:"https://api.github.com/gists",type:"POST",dataType:"json",data:JSON.stringify(i)}).success(function(t){window.location.hash=t.html_url.split("https://gist.github.com/").join(""),hash=window.location.hash.replace(/#/g,""),$("[data-action=saved]").text(document.domain+"/#"+hash),$("[data-action=saved]").attr("href",document.domain+"/#"+hash).attr("target","_blank")}).error(function(t){console.warn("gist save error",t),$("[data-action=saved]").text("gist save error",t)})});var hash=window.location.hash.substring(1);window.location.hash&&loadgist(hash);